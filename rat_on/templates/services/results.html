{% extends 'base.html' %}

{% load static %}
{% load pretty %}


{% block title %}Response Times{% endblock %}

{% block body_title %}{{ category|pretty }}{% endblock %}

{% block container %}

    <div style="width: 100%;">
        <canvas id="myChart"></canvas>
    </div>

    <script src="{% static 'js/chart.js' %}"></script>
    <script>
        const borderColors = [
            'rgb(75, 192, 192)',
            'rgb(192, 75, 192)',
            'rgb(192, 192, 75)',
        ];
        const data = {
        labels: [
        {% for key, value in services_data.items %}
            {% if forloop.counter0 == 0 %}
                {% for tuple in value %}
                    new Date('{{ tuple.0|safe }}').toLocaleTimeString([], { hour: '2-digit', minute: "2-digit", second: "2-digit", hour12: false}),
                {% endfor %}
            {% endif %}
        {% endfor %}
        ],
        datasets: [
        {% for key, value in services_data.items %}
        {
            
            label: '{{ key|pretty }}',
            data: [
            {% for k, value in services_data.items %}
                {% if key == k %}
                    {% for tuple in value %}
                        {{ tuple.1|safe }},
                    {% endfor %}
                {% endif %}
            {% endfor %}
            ],
            fill: false,
            borderColor: borderColors[{{ forloop.counter0 }}],
            tension: 0.1

        },
        {% endfor %}
        ]
        };
        const config = {
            type: 'line',
            data: data,
        };
        var myChart = new Chart(
            document.getElementById('myChart'),
            config
        );
    </script>

{% endblock %}
